<h2 class="mb-4">Appointments</h2>

<% if (user && (user.role === "doctor" || user.role === "admin")) { %>
  <a href="/appointments/add" class="btn btn-primary mb-3">+ New Appointment</a>
<% } %>


<table class="table table-striped table-hover">
  <thead class="table-dark">
    <tr>
      <th>#</th>
      <th>Patient</th>
      <th>Doctor</th>
      <th>Date</th>
      <th>Reason</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% appointments.forEach((appt, idx)=> { %>
      <tr>
        <td>
          <%= idx + 1 %>
        </td>
        <td>
          <%= appt.Patient?.name %>
        </td>
        <td>
          <%= appt.Doctor?.name %>
        </td>
        <td>
          <%= formatDate(appt.appointmentDate) %>
        </td>
        <td>
          <%= appt.reason %>
        </td>
        <td>
          <a href="/appointments/<%= appt.id %>" class="btn btn-sm btn-info">Detail</a>

          <% if (user.role==="admin" || user.role==="doctor" ) { %>
            <a href="/appointments/<%= appt.id %>/edit" class="btn btn-sm btn-warning">Edit</a>
            <a href="/appointments/<%= appt.id %>/delete" class="btn btn-sm btn-danger"
              onclick="return confirm('Are you sure?')">Delete</a>
            <% } %>
        </td>

      </tr>
      <% }) %>
  </tbody>
</table>